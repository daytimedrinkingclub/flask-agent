{% extends 'base.html' %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-2xl font-bold mb-4">Chat Progress</h1>
    
    <div class="bg-white shadow-md rounded-lg p-6 mb-6">
        <p class="text-lg font-semibold mb-2">Current Status: <span id="chat-status" class="text-blue-600">{{ chat_status }}</span></p>
        <p class="text-gray-600">Chat ID: {{ chat_id }}</p>
    </div>

    <div id="chat-messages" class="bg-white shadow-md rounded-lg p-6 mb-6 h-96 overflow-y-auto">
        {% for message in messages %}
            <div class="mb-4 {% if message.role == 'user' %}text-right{% endif %}">
                <span class="font-bold">{{ message.role|title }}:</span>
                <p>{{ message.content }}</p>
            </div>
        {% endfor %}
    </div>

    <div id="user-input-form" class="bg-white shadow-md rounded-lg p-6 {% if chat_status != 'need_input' %}hidden{% endif %}">
        <h2 class="text-xl font-bold mb-4">User Input Required</h2>
        <form action="{{ url_for('main.send_message', chat_id=chat_id) }}" method="post">
            <div class="mb-4">
                <label for="user_input" class="block text-gray-700 text-sm font-bold mb-2">Your Input:</label>
                <textarea id="user_input" name="user_input" rows="4" class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none" required></textarea>
            </div>
            <div class="flex items-center justify-between">
                <button type="submit" class="bg-black hover:bg-gray-800 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                    Submit
                </button>
            </div>
        </form>
    </div>

    <a href="{{ url_for('main.dashboard') }}" class="mt-4 inline-block bg-black hover:bg-gray-800 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
        Back to Dashboard
    </a>
</div>

<script>
    var chatId = '{{ chat_id }}';
</script>
{% endblock %}